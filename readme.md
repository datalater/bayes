ⓒ JMC 2017

**주요 소스**  
세상에서 가장 쉬운 베이즈통계학 입문, 고지마 히로유키

**RESUME**  
`제4강 확률의 확률을 사용하여 추정의 폭을 넓힌다`

---

**목차**

<ul>
<li><a href="#제1강-정보를-얻으면-확률이-바뀐다">제1강 정보를 얻으면 확률이 바뀐다</a></li>
<li><a href="#제2강-베이즈-추정은-때로-직감에-크게-반한다">제2강 베이즈 추정은 때로 직감에 크게 반한다t</a></li>
<li><a href="#제3강-주관적인-숫자여도-추정이-가능하다">제3강 주관적인 숫자여도 추정이 가능하다</a></li>
</ul>

---

# 제3강 주관적인 숫자여도 추정이 가능하다

## 용어 정리

+ `이유 불충분의 원리` : 주장과 반박에 대해 양쪽 다 어떠한 근거도 없을 때는 일단 대등하다고 생각한다.

## Summary

## 곤란한 상황에서 쓰는 '이유 불충분의 원리'

### 지금까지의 베이즈 추정의 단계

1. 사전확률
2. 조건부 확률
3. 관측에 의한 정보 입수
4. 사후확률

제1강과 제2강에서 사전확률은 객관적인 데이터를 참고하여 설정했다. 그러나 '**객관적인 사전 데이터가 없어도 추정이 가능하다**'는 것이 '**베이즈 추정의 진정한 면모**'이다. 즉 '**사전확률을 주관적으로 설정하여 추정을 실시할 수가 있다**'는 뜻이다.

### 문제설정

+ 당신은 남성이다.
+ 특정 여성 동료가 자신에게 호감을 가지고 있는지 알고 싶다.
+ 그런 와중에 밸런타인데이에 그녀로부터 초콜릿을 받았다.
+ 이때 그녀가 당신을 진지하게 생각하고 있을 확률이 얼마라고 추정해야 할까?

이 문제설정의 가장 중요한 포인트는 '**사람의 속마음을 수치화해야 한다**'는 점이다. 여기에는 객관성이 전혀 없다.

또 여기서 말하는 '마음에 두고 있을 확률'에서의 **'확률'이 뜻하는 바도 생각할수록 그 의미가 와 닿지 않는다**.

이번 문제설정은 통상의 통계/확률의 상식에서 상당히 일탈됐다. 하지만 베이즈 추정은 이와 같은 문제에도 접근할 수 있다. 거꾸로 말하면 이 점이 베이즈 추정의 진가를 발휘할 수 있는 강점이라 할 만하다.

### 1단계 : 주관적으로 사전확률을 설정한다.

+ 타입을 `진심`과 `논외`로 약칭한다.
    + `진심` : 그녀가 당신을 마음에 두고 있다.
+ 이때는 '이유 불충분의 원리'를 끌어다 써서 일단 대등하다고 생각한다.
    + `진심` : 0.5
    + `논외` : 0.5

> **Note:** 이유 불충분의 원리 : 통계적인 접근이 불가능한 데다 어느 쪽이 우세하다고 생각할 근거도 없으므로 임의의 수치로 대등하게 0.5씩 할당한다.

### 2단계 : 특정 행동에 대한 조건부 확률을 설정한다.

+ '여성이 마음에 두고 있는 남성과 논외인 남성에게 각각 어느 정도의 확률로 초콜릿을 주는가'를 알아내기 위해 앙케이트 조사를 잡지사에 부탁했다.
+ 진심으로 생각하는 상대에게 주는 확률이 50% 이하라는 것도 의외였지만, 논외인 상대에게 22%나 되는 확률로 준다는 것에 '예의상 초콜릿을 주는 습관'의 대단함을 실감했다.

| 타입 | 초콜릿을 줄 확률 | 초콜릿을 주지 않을 확률 |
| :--- | :--- | :--- |
| 진심 | 0.4 | 0.6 |
| 논외 | 0.2 | 0.8 |

+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | 진심 (0.5) | 논외 (0.5) |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 (0.4, 0.2) | 0.2 | 0.1 |
| 초콜릿을 주지 않을 확률 (0.6, 0.8) | 0.3 | 0.4 |

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 초콜릿을 받은 현실에 직면해 있다.
+ 초콜릿을 주지 않을 확률을 제거한다.

| 타입 | 진심 (0.5) | 논외 (0.5) |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 (0.4, 0.2) | 0.2 | 0.1 |

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해서 1이 되도록 정규화시킨다.
    + 0.2 : 0.1 = 2/3 : 1/3

| 타입 | 진심| 논외 |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 | 2/3 | 1/3 |

+ 초콜릿을 받았을 때, 그녀가 당신을 `진심`으로 생각할 사후확률은 약 66%이다.

## Insight#1

베이즈 갱신 결과,

+ 사전확률 0.5에서 사후확률 0.66으로 올라갔다.
+ 초콜릿을 받았기 때문에 당신의 기대감이 이전보다 높아지는 것은 당연하다.
+ 그래도 66%에 머물기 때문에 과잉 기대는 금물이다.

이유 불충분의 상황이라 하더라도 사전확률을 반반으로 설정하는 것은 너무 자신감 넘치는 행위가 아닌지 느낀다면,

+ `진심` : 0.4, `논외` : 0.6으로 설정하면 된다.

## Insight#2

### 주관적 확률

학교 교육에서 배우는 확률은 객관적 확률이다. 누가 계산하든 같은 값이 나온다는 점에서 객관성을 띤다.
가령 '주사위를 던져서 1이 나올 확률이 6분의 1'이라고 한다면, 그것은 '이 주사위를 던질 때 1이 나올 가능성의 정도'를 나타내며 이는 모든 사람의 공통된 판단으로 여긴다.

그러나 이번 강의에서 다룬 확률에는 그러한 객관성이 적용되지 않는다.
'동료 여성이 당신을 마음에 두고 있을 확률'에서 '확률'이란 종래의 주사위의 확률과 같은 해석이 불가능하다.

객관적 확률은 n번 실험하여 특정 이벤트가 일어나는 상대적 빈도로 확률을 정의한다. 따라서 주사위도 여러 차례 던질 수 있음을 전제로 한다.
하지만 이 여성은 세상에 단 한 명이고 당신에 대해 진심으로 생각하는 경우를 여러 번 실험하여 일어나는 상대적 빈도로 계산할 수 없다.
그리고 그녀가 당신을 진심 혹은 논외로 생각하는가를 결정하는 것은, 앞으로 일어날 확률적인 사항이 아니라 이미 결론이 나 있고 그저 당신이 그것에 모르는 것에 지나지 않는다.

따라서 '동료 여성이 당신을 마음에 두고 있을 확률'에서 그 '확률'은 **당신 마음 속의 '믿음의 정도'와 같은 것이라고 해석해야 한다**.
즉 '확률은 몇이다'가 아니라, 오히려 '나는 확률이 몇이라고 생각한다'라는 의미로 이해해야 한다.

이와 같이 '사람이 마음으로 생각하는 수치'라고 해석하는 확률을 '**주관적 확률**'이라고 한다.

믿을 수 없는 것이라고 여기는 사람이 많고 학교 교육에서도 배우지 않는다. 물론 객관적 확률은 명쾌하고 엄밀하다.
하지만 실제로 쓸 데가 한정되어 있다.
그러나 주관적 확률은 확률의 사고법으로써는 유서 깊은 방식이며, 통계학이나 경제학에서는 당당히 사용되는 개념이다.


> **Note:** 17세기 인도의 수학자 라이프니츠는 '신빙성', '증거능력'이 확률이라고 생각했다. 법학자이기도 했던 라이프니츠는 재판에서의 추론을 고찰했다. 재판에서는 피고인의 유죄를 증거로부터 증명해 나간다. 이때 피고인이 유죄일 '신빙성'은 주관 확률로 구성된다고 해석했다.

**끝.**

---

# 제2강 베이즈 추정은 때로 직감에 크게 반한다

## 용어 정리

## Summary

## 객관적인 데이터를 사용할 때 주의할 점

### 스토리

+ 어떤 환자가 '특정 암에 걸려 있다면 95%의 확률로 양성이 나오는 검사'를 받았다.
+ 양성 판정이 나왔다.
+ 그 환자가 암에 걸려 있을 확률이 95%일까?
+ 정답은 '아니오'이다.
+ 양성이라는 '결과'로부터 '암이다'라는 '원인'으로 거슬러 올라가는 추정이므로, 베이즈 추정의 전형적인 예시이다.

### 문제설정

+ 암에 걸릴 확률(이환율) = 0.1%(0.001)
+ 암에 걸린 사람이 양성으로 진단받을 확률 = 95%(0.95)
+ 건강한 사람이 양성으로 오진 받을 확률 = 2%(0.02)
+ 검사에서 양성이라고 진단받았을 때, 실제로 이 암에 걸려 있을 확률은 얼마일까?

### 1단계 : 사전확률을 설정한다.

+ 환자를 두 가지 타입으로 나눈다
    + `암에 걸린 사람`과 `건강한 사람`
+ 타입에 대한 비율을 경험에 비추어 정한다.
    + `암에 걸린 사람` : 0.001
    + `건강한 사람` : 0.999

### 2단계 : 특정 행동에 대한 조건부 확률을 설정한다.

| 타입 | 양성일 확률 | 음성일 확률 |
| :--- | :--- | :--- |
| 암에 걸린 사람 (0.001) | 0.95 | 0.05 |
| 건강한 사람 0.999) | 0.02 | 0.98 |

+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|
| 음성 (0.05, 0.98) | 0.005% | 97.902% |

+ 가독성을 우선시하여 100배하여 %로 나타내었다.

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 검사 결과가 양성이다.
+ 음성에 대한 경우를 제거한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해서 1이 되도록 정규화시킨다.
    + 0.095 : 1.998 = 0.095/2.093 : 1.998/2.093

> **Note:** 0.095 + 1.998 = 2.093

| 타입 | 암에 걸린 사람 | 건강한 사람 |
| :--- | :--- | :--- |
| 양성 | 0.0454 | 0.9546|

+ 양성이 나온 사람이 암에 걸렸을 확률은 약 4.5%이다.

## Insight

위 내용을 두 문장으로 요약하면 다음과 같다.

+ '95% 감도인 암 검사에서 양성이 나온다면 당신은 95%의 확률로 암인가?'
+ 아니다. 95%는커녕 불과 4.5%이다.

왜 이렇게 확률이 낮을까?

+ 첫째, 원래 암에 걸린 사람(0.1%) 자체가 매우 드물다.
+ 둘째, 건강한 사람을 양성으로 진단하는 확률은 2%이므로 적어보이지만, 건강한 사람이 압도적으로 많으므로 건강한 사람을 양성으로 진단하는 사례는 실제로 무시할 수 없을 만큼 많다.

그렇다면 완전히 마음을 놓아도 될까?

+ 그 또한 아니다.
+ 아무런 관측이 이루어지지 않았을 때, 당신이 암에 걸렸을 확률은 0.001 (사전확률)이었다.
+ '양성'이 관측된 후에는 수치가 갱신되어 0.045(사후확률)가 되었다.
+ 즉, 0.1%에서 4.5%로 45배 커졌다.
+ 검사 결과를 보기 전에는 1000명 중에 1명 정도의 가능성이었으나,
+ 검사 결과 양성이 나온 지금은 약 20명 중 1명 정도의 가능성으로 높아졌다.
+ 결코 방치해도 되는 상태는 아니다.

**끝.**

---

# 제1강 정보를 얻으면 확률이 바뀐다

## 용어 정리

+ `사전확률` : 타입(input)에 대한 확률
+ `정규화 조건` : 각 타입의 사전확률의 합이 1이 되도록 함
+ `조건부 확률` : 특정 타입이 특정 행동(output)을 할 확률
    + 타입(원인)을 알고 있을 때의 결과의 확률
+ `베이즈 역확률` 또는 `사후확률` :
    + 특정 타입(input)이 특정 행동(output)을 할 확률이 사전확률인 반면,
    + 특정 행동(output)을 한 사람이 특정 타입(input)일 확률을 역으로 구하므로 역확률이라고 한다
+ `베이즈 갱신` : 사전확률과 조건부 확률을 설정한 상태에서 새롭게 관측한 행동을 반영하여 사후 확률을 구하는 것. (기존 확률을 업데이트한다)
+ `베이즈 추정` : 사전확률을 행동의 관찰을 통해 사후확률로 베이즈 갱신을 하는 것

## Summary

베이즈 추정은 사전확률과 조건부 확률을 설정한 이후 특정 행동을 관찰해서 사후확률을 업데이트한다. 이는 직감적인 판단을 수치화하여 계산하는 방법이며, AI에 활용할 수도 있다.

## 베이즈 추정의 기본적인 사용 방법

### 스토리

+ 상품 판매점 점원은 손님이 '`쇼핑족`인가 아니면 `아이쇼핑족`인가'를 판별하고 싶다.
+ `쇼핑족`에게는 원하는 상품을 소개하여 실제로 구매하도록 유도해야 한다.
+ `아이쇼핑족`에게는 시간을 들여 설명해도 구매하지 않을 뿐더러 손님 입장에서 귀찮게 느끼므로 역효과이다.

### 1단계 : 경험에서 '사전확률'을 설정한다

+ 손님의 두 가지 타입을 나눈다
    + `쇼핑족`과 `아이쇼핑족`
+ 타입을 나누고 그 비율이 각각 몇인지 **경험에 비추어** 수치를 배정한다.
    + `쇼핑족` : 0.2
    + `아이쇼핑족` : 0.8
+ 단, 사전확률은 전부 더해서 1이 되도록 설정한다.

> **Note:** 사전확률은 보통 경험에 근거해 할당하지만, 경험이 없는 경우도 할당할 수도 있다. 추후 언급할 것이다.

### 2단계 : 타입별로 특정 행동에 대한 '조건부 확률'을 설정한다

+ 특정 행동은 반드시 상호배타적이어야 하며, 정규화 조건을 만족해야 한다.
+ `쇼핑족` 손님과 `아이쇼핑족` 손님이 각각 점원에게 '말 걸기' 행동을 할 확률을 **반드시 근거가 있는 경험에 비추어** 정한다.

> **Note:** 사전확률은 경험이 없어도 할당할 수 있다. 그러나 타입의 차이에 따른 행동의 확률은 어떤 경험, 실증, 실험에 기반을 둔 수치가 반드시 필요하다.

| 타입 | 말을 걸 확률 | 말을 걸지 않을 확률 |
| :--- | :--- | :--- |
| 쇼핑족 (0.2) | 0.9 | 0.1 |
| 아이쇼핑족 0.8) | 0.3 | 0.7 |

+ 각 타입의 '말을 걸 확률'과 '말을 걸지 않을 확률'의 합은 1이다.
+ 위 표에 제시된 확률은 '조건부 확률'이다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |
| 말을 걸지 않는다 (0.1, 0.7) | 0.02 | 0.56 |

+ 전체 세계의 관점에서 각 타입이 특정 행동을 할 최종 확률은 위 표와 같다.

### 3단계 : 관측한 행동에서 '가능성이 사라진 세계'를 제거한다

+ 지금 손님이 말을 걸었다.
+ 손님의 행동을 한 가지 관측했으므로 가능성이 사라진 '말을 걸지 않는' 행동을 제거한다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |

### 4단계 : 특정 타입에 대한 베이즈 역확률을 구한다

+ 4개의 가능성에서 2개의 가능성으로 좁혀졌다.
+ 전체 확률을 더해도 1이 되지 않으므로, 정규화 조건을 회복시킨다.
    + 0.18 : 0.24 = 3 : 4 = 3/7 : 4/7

| 타입 | 쇼핑족 | 아이쇼핑족 |
| :--- | :--- | :--- |
| 말을 건다 | 3/7 | 4/7 |

+ 말을 걸어온 손님이 `쇼핑족`일 확률은 3/7이다.
+ 이 확률을 '베이즈 역확률' 또는 '사후확률'이라 부른다.

## Outline

1. 타입에 대한 사전확률을 설정한다.
    + ex. 쇼핑족과 아이쇼핑족
2. 각 타입의 행동에 대한 조건부 확률을 설정한다.
    + ex. 각각 말을 걸 확률은?
3. 행동을 관측한다.
    + ex. 말을 걸어왔다.
4. 일어나지 않을 행동에 대한 가능성을 제거한다.
    + ex. 말을 걸지 않는 경우를 지운다.
5. 남아 있는 경우의 확률을 정규화한다.
    + ex. 남아 있는 경우의 확률이 1이 되도록 만든다.
6. 사후확률 (베이즈 역확률)을 구한다.
    + ex. 가능성을 갱신해서 말을 거는 손님이 살 확률을 구한다.

**끝.**

---
