ⓒ JMC 2017

**주요 소스**  
세상에서 가장 쉬운 베이즈통계학 입문, 고지마 히로유키

---

# 제2강 베이즈 추정은 때로 직감에 크게 반한다

## 용어 정리

## Summary

## 객관적인 데이터를 사용할 때 주의할 점

### 스토리

+ 어떤 환자가 '특정 암에 걸려 있다면 95%의 확률로 양성이 나오는 검사'를 받았다.
+ 양성 판정이 나왔다.
+ 그 환자가 암에 걸려 있을 확률이 95%일까?
+ 정답은 '아니오'이다.
+ 양성이라는 '결과'로부터 '암이다'라는 '원인'으로 거슬러 올라가는 추정이므로, 베이즈 추정의 전형적인 예시이다.

### 문제설정

+ 암에 걸릴 확률(이환율) = 0.1%(0.001)
+ 암에 걸린 사람이 양성으로 진단받을 확률 = 95%(0.95)
+ 건강한 사람이 양성으로 오진 받을 확률 = 2%(0.02)
+ 검사에서 양성이라고 진단받았을 때, 실제로 이 암에 걸려 있을 확률은 얼마일까?

### 1단계 : 사전확률을 설정한다.

+ 환자를 두 가지 타입으로 나눈다
    + `암에 걸린 사람`과 `건강한 사람`
+ 타입에 대한 비율을 경험에 비추어 정한다.
    + `암에 걸린 사람` : 0.001
    + `건강한 사람` : 0.999

### 2단계 : 특정 행동에 대한 조건부 확률을 설정한다.

| 타입 | 양성일 확률 | 음성일 확률 |
| :--- | :--- | :--- |
| 암에 걸린 사람 (0.001) | 0.95 | 0.05 |
| 건강한 사람 0.999) | 0.02 | 0.98 |

+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|
| 음성 (0.05, 0.98) | 0.005% | 97.902% |

+ 가독성을 우선시하여 100배하여 %로 나타내었다.

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 검사 결과가 양성이다.
+ 음성에 대한 경우를 제거한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해서 1이 되도록 정규화시킨다.
    + 0.095 : 1.998 = 0.095/2.093 : 1.998/2.093

> **Note:** 0.095 + 1.998 = 2.093

| 타입 | 암에 걸린 사람 | 건강한 사람 |
| :--- | :--- | :--- |
| 양성 | 0.0454 | 0.9546|

+ 양성이 나온 사람이 암에 걸렸을 확률은 약 4.5%이다.

## Insight

위 내용을 두 문장으로 요약하면 다음과 같다.

+ '95% 감도인 암 검사에서 양성이 나온다면 당신은 95%의 확률로 암인가?'
+ 아니다. 95%는커녕 불과 4.5%이다.

왜 이렇게 확률이 낮을까?

+ 첫째, 원래 암에 걸린 사람(0.1%) 자체가 매우 드물다.
+ 둘째, 건강한 사람을 양성으로 진단하는 확률은 2%이므로 적어보이지만, 건강한 사람이 압도적으로 많으므로 건강한 사람을 양성으로 진단하는 사례는 실제로 무시할 수 없을 만큼 많다.

그렇다면 완전히 마음을 놓아도 될까?

+ 그 또한 아니다.
+ 아무런 관측이 이루어지지 않았을 때, 당신이 암에 걸렸을 확률은 0.001 (사전확률)이었다.
+ '양성'이 관측된 후에는 수치가 갱신되어 0.045(사후확률)가 되었다.
+ 즉, 0.1%에서 4.5%로 45배 커졌다.
+ 검사 결과를 보기 전에는 1000명 중에 1명 정도의 가능성이었으나,
+ 검사 결과 양성이 나온 지금은 약 20명 중 1명 정도의 가능성으로 높아졌다.
+ 결코 방치해도 되는 상태는 아니다.

**끝.**

---

# 제1강 정보를 얻으면 확률이 바뀐다

## 용어 정리

+ `사전확률` : 타입(input)에 대한 확률
+ `정규화 조건` : 각 타입의 사전확률의 합이 1이 되도록 함
+ `조건부 확률` : 특정 타입이 특정 행동(output)을 할 확률
    + 타입(원인)을 알고 있을 때의 결과의 확률
+ `베이즈 역확률` 또는 `사후확률` :
    + 특정 타입(input)이 특정 행동(output)을 할 확률이 사전확률인 반면,
    + 특정 행동(output)을 한 사람이 특정 타입(input)일 확률을 역으로 구하므로 역확률이라고 한다
+ `베이즈 갱신` : 사전확률과 조건부 확률을 설정한 상태에서 새롭게 관측한 행동을 반영하여 사후 확률을 구하는 것. (기존 확률을 업데이트한다)
+ `베이즈 추정` : 사전확률을 행동의 관찰을 통해 사후확률로 베이즈 갱신을 하는 것

## Summary

베이즈 추정은 사전확률과 조건부 확률을 설정한 이후 특정 행동을 관찰해서 사후확률을 업데이트한다. 이는 직감적인 판단을 수치화하여 계산하는 방법이며, AI에 활용할 수도 있다.

## 베이즈 추정의 기본적인 사용 방법

### 스토리

+ 상품 판매점 점원은 손님이 '`쇼핑족`인가 아니면 `아이쇼핑족`인가'를 판별하고 싶다.
+ `쇼핑족`에게는 원하는 상품을 소개하여 실제로 구매하도록 유도해야 한다.
+ `아이쇼핑족`에게는 시간을 들여 설명해도 구매하지 않을 뿐더러 손님 입장에서 귀찮게 느끼므로 역효과이다.

### 1단계 : 경험에서 '사전확률'을 설정한다

+ 손님의 두 가지 타입을 나눈다
    + `쇼핑족`과 `아이쇼핑족`
+ 타입을 나누고 그 비율이 각각 몇인지 **경험에 비추어** 수치를 배정한다.
    + `쇼핑족` : 0.2
    + `아이쇼핑족` : 0.8
+ 단, 사전확률은 전부 더해서 1이 되도록 설정한다.

> **Note:** 사전확률은 보통 경험에 근거해 할당하지만, 경험이 없는 경우도 할당할 수도 있다. 추후 언급할 것이다.

### 2단계 : 타입별로 특정 행동에 대한 '조건부 확률'을 설정한다

+ 특정 행동은 반드시 상호배타적이어야 하며, 정규화 조건을 만족해야 한다.
+ `쇼핑족` 손님과 `아이쇼핑족` 손님이 각각 점원에게 '말 걸기' 행동을 할 확률을 **반드시 근거가 있는 경험에 비추어** 정한다.

> **Note:** 사전확률은 경험이 없어도 할당할 수 있다. 그러나 타입의 차이에 따른 행동의 확률은 어떤 경험, 실증, 실험에 기반을 둔 수치가 반드시 필요하다.

| 타입 | 말을 걸 확률 | 말을 걸지 않을 확률 |
| :--- | :--- | :--- |
| 쇼핑족 (0.2) | 0.9 | 0.1 |
| 아이쇼핑족 0.8) | 0.3 | 0.7 |

+ 각 타입의 '말을 걸 확률'과 '말을 걸지 않을 확률'의 합은 1이다.
+ 위 표에 제시된 확률은 '조건부 확률'이다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |
| 말을 걸지 않는다 (0.1, 0.7) | 0.02 | 0.56 |

+ 전체 세계의 관점에서 각 타입이 특정 행동을 할 최종 확률은 위 표와 같다.

### 3단계 : 관측한 행동에서 '가능성이 사라진 세계'를 제거한다

+ 지금 손님이 말을 걸었다.
+ 손님의 행동을 한 가지 관측했으므로 가능성이 사라진 '말을 걸지 않는' 행동을 제거한다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |

### 4단계 : 특정 타입에 대한 베이즈 역확률을 구한다

+ 4개의 가능성에서 2개의 가능성으로 좁혀졌다.
+ 전체 확률을 더해도 1이 되지 않으므로, 정규화 조건을 회복시킨다.
    + 0.18 : 0.24 = 3 : 4 = 3/7 : 4/7

| 타입 | 쇼핑족 | 아이쇼핑족 |
| :--- | :--- | :--- |
| 말을 건다 | 3/7 | 4/7 |

+ 말을 걸어온 손님이 `쇼핑족`일 확률은 3/7이다.
+ 이 확률을 '베이즈 역확률' 또는 '사후확률'이라 부른다.

## Outline

1. 타입에 대한 사전확률을 설정한다.
    + ex. 쇼핑족과 아이쇼핑족
2. 각 타입의 행동에 대한 조건부 확률을 설정한다.
    + ex. 각각 말을 걸 확률은?
3. 행동을 관측한다.
    + ex. 말을 걸어왔다.
4. 일어나지 않을 행동에 대한 가능성을 제거한다.
    + ex. 말을 걸지 않는 경우를 지운다.
5. 남아 있는 경우의 확률을 정규화한다.
    + ex. 남아 있는 경우의 확률이 1이 되도록 만든다.
6. 사후확률 (베이즈 역확률)을 구한다.
    + ex. 가능성을 갱신해서 말을 거는 손님이 살 확률을 구한다.

**끝.**

---
