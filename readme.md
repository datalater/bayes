ⓒ JMC 2017

**주요 소스**  
세상에서 가장 쉬운 베이즈통계학 입문, 고지마 히로유키

**RESUME**  
`제8강 베이즈 추정은 '최우원리'에 근거해 있다`

---

**목차**

<ul>
<li><a href="#제1강-정보를-얻으면-확률이-바뀐다">제1강 정보를 얻으면 확률이 바뀐다</a></li>
<li><a href="#제2강-베이즈-추정은-때로-직감에-크게-반한다">제2강 베이즈 추정은 때로 직감에 크게 반한다t</a></li>
<li><a href="#제3강-주관적인-숫자여도-추정이-가능하다">제3강 주관적인 숫자여도 추정이 가능하다</a></li>
<li><a href="#제4강-확률의-확률을-사용하여-추정의-폭을-넓힌다">제4강 확률의 확률을 사용하여 추정의 폭을 넓힌다</a></li>
<li><a href="#제5강-추론의-프로세스에서-부각되는-베이즈-추정의-특징">제5강 추론의 프로세스에서 부각되는 베이즈 추정의 특징</a></li>
<li><a href="#제6강-명쾌하고-엄밀하지만-쓸-데가-한정된-네이만-피어슨-식-추정">제6강 명쾌하고 엄밀하지만 쓸 데가 한정된 네이만-피어슨 식 추정</a></li>
<li><a href="#제7강-베이즈-추정은-적은-양의-정보로-그럴듯한-결론을-이끌어-낸다">제7강 베이즈 추정은 적은 양의 정보로 그럴듯한 결론을 이끌어 낸다</a></li>
</ul>

---

# 제8강 베이즈 추정은 '최우원리'에 근거해 있다

## 용어 정리

+ `최우원리` : 세상에 일어나는 일의 원인을 생각할 때, 일어날 확률이 더 큰 쪽이 원인일 것이라고 생각하는 사고

## Summary

표준 통계학과 베이즈통계학에는 '최우원리'라는 공통된 발상이 있다.

## 베이즈통계학과 네이만-피어슨 통계학의 접점

### 베이즈통계학과 표준 통계학의 공통점

앞에서는 두 가지 통계학의 사고법의 차이, 논리의 차이에 대해 해설했다.
이로써 두 가지 통계학에는 무시할 수 없는 차이가 있음을 알 수 있다.
특히 '**베이즈통계학에서는 네이만-피어슨 통계학에서 설정하지 않는 사전확률이라는 것을 도입했다**'는 사항이 눈에 띈다.
이것은 추정하려는 것의 원인으로 여겨지는 대상을 복수 상정하여, 각각에 대해 '그것이 일어날 가능성'쯤으로 사전확률을 설정하는 것이었다.

그런데 이와 같은 발상이 베이즈통계학만의 고유한 것은 아니다.
네이만-피어슨 통계학에도 공통된 발상이 적용되어 있다.
공통된 발상을 이해한다면 베이즈통계학의 사전확률에 대해 많은 사람들이 느끼는 위화감이 다소 누그러질 것이다.


### 여러 학문에서 두루 쓰이는 최우원리

최우원리란 쉽게 말해 '**세상에 일어나는 일은 일어날 확률이 큰 것이다**'라는 원리이다.

예컨대 누군가 어디에 물건을 두고 와 잃어버렸는데, 그것은 A나 B 중 어느 한 사람이라고 치자. A씨는 물건을 자주 잃어버리는 사람이며 B씨는 그런 일이 거의 없는 사람이다. 이때 대개는 물건을 잃어버린 쪽이 A씨일 것이라고 추론할 것이다.

이렇듯 '**일어날 확률이 더 큰 쪽이 원인일 것이라고 생각하는 사고**'를 '**최우원리**'라고 한다.

이처럼 최우원리는 우리에게 매우 익숙한 사고법이며 많은 학문 분야에 이용되어 왔다. 특히 물리학 중에서도 통계물리학 분야에서 뚜렷이 드러난다. 통계물리에서는 최우원리를 이용해 다양한 물리 현상을 해명하고 있다.

### 최우원리에 근거하고 있는 베이즈 추정



---

# 제7강 베이즈 추정은 적은 양의 정보로 그럴듯한 결론을 이끌어 낸다

## 용어 정리

## Summary

## 네이만-피어슨 식 추정과 다른 점

### 베이즈 추정으로 항아리 문제 풀기

베이즈 추정을 사용하면 유의수준과 같은 개념이 필요없이 확률적 추론을 적용할 수 있다.

### 문제 설정

+ `사실 1` : 눈 앞에 항아리 A와 항아리 B가 있다.
+ `사실 2` : A에는 대체로 흰 공이 들어있다 (흰공:검은공=9:1)
+ `사실 3` : B에는 대체로 검은 공이 들어있다 (흰공:검은공=2:8)
+ `사실 4` : 검은 공이 나왔다

### 1단계 : 타입과 사전확률을 설정한다

+ 타입은 둘 중에 하나이다.
    + A
    + B
+ 사전확률을 설정해야 하는데 눈 앞의 항아리가 A인지 B인지 알 수가 없고, 공을 관측하기 전에는 어느 쪽에 가까울지도 모르기 때문에 이유 불충분의 원리를 쓰는 수밖에 없다.
    + 타입 A에 대한 사전확률 : 0.5
    + 타입 B에 대한 사전확률 : 0.5

| 타입 | A | B |
| :--- | :--- | :--- |
| 사전확률 | 0.5 | 0.5 |


### 2단계 : 조건부 확률을 설정한다

+ 각 타입에 따라 검은공 또는 흰공이 나올 조건부 확률을 설정한다.
+ 항아리 A이면서
    + 검은 공 : 0.1
    + 흰 공 : 0.9
+ 항아리 B이면서
    + 검은 공 : 0.8
    + 흰 공 : 0.2

| 타입 | A (0.5) | B (0.5) |
| :--- | :--- | :--- |
| 검은 공 (0.1, 0.8) | 0.05 | 0.4 |
| 흰 공 (0.9, 0.2) | 0.45 | 0.1 |

### 3단계 : 일어날 가능성이 없는 세계를 지운다

+ 관측된 공의 색이 검정이므로 흰 공이 속한 세계를 소거하자.

| 타입 | A (0.5) | B (0.5) |
| :--- | :--- | :--- |
| 검은 공 (0.1, 0.8) | 0.05 | 0.4 |

### 4단계 : 정규화시켜서 베이즈 역확률을 구한다

+ 전체 확률을 더해 1이 되도록 정규화시킨다.
    + 0.05 : 0.4
    + 1 : 8
    + 1/9 : 8/9

| 타입 | A | B |
| :--- | :--- | :--- |
| 검은 공 | 1/9 | 8/9 |

+ 검은 공이 관측된 이후에는,
    + 항아리 A일 사후확률 = 1/9 = 약 0.11
    + 항아리 B일 사후확률 = 8/9 = 약 0.89
+ 후자가 전자보다 8배나 크므로 항아리는 B라고 판단하는 것이 타당할 것이다.

### Insight ::: 베이즈 추정은 어떤 환경에서도 '일단' 추정을 내린다

네이만-피어슨 통계학의 가설검정과 달리,

+ 유의수준의 설정이 없으므로 어떤 환경에서든 '일단' 추정이 가능하다는 장점이 있다.
+ 단, 네이만-피어슨 식과 같이 A와 B 어느 한쪽으로 판정을 내리는 것이 아니라 양쪽의 가능성을 남겨둔 채 그 가능성의 비율 관계를 제시하는 것이 전부다.
+ 수치를 보고 판단을 내리는 일은 통계가의 몫으로 남겨진다.

> **Note:** 그래서 베이즈 추정을 두고 '사장의 확률'이라고 부르기도 한다. 베이즈 추정은 사원에게 맡기고 보고 받은 수치를 보고 판단을 내리는 것은 사장의 재량이라는 의미에서다.

### Insight ::: 가장 주의해야 할 리스크에 대한 의미 차이

베이즈 추정과 네이만-피어슨식 추정에서 리스크의 의미는 완전히 다르다.

네이만-피어슨 식 추정에서 리스크란,

+ 유의수준이라는 것이 리스크의 지표가 된다.
+ 예컨대 유의수준을 5%로 설정한 경우는 '**같은 방법으로 가설검정을 되풀이하는 경우에 5%의 확률로 잘못된 결론을 내린다**'는 것을 뜻한다.
+ 다시 말해 5%라는 리스크는 '지금 내린 결론'에 대한 직접적인 평가가 아니다.
+ 여기서 리스크는 어디까지나 사용하고 있는 방법론에 대한 것이며 '5%의 리스크가 있는 방법으로 내린 결론'이라는 간접적인 평가치가 된다.

베이즈 추정에서 리스크란,

+ '**리스크 평가는 사후확률 그 자체가 된다**'고 생각할 수 있다.
+ 항아리 추정의 예에서는 '항아리 B일 사후확률'이 약 0.11로 산출되었기 때문에 '눈 앞의 항아리는 B일 것이다'라고 결론을 내리면 잘못된 결론일 확률이 약 0.11이 된다.
+ 이것은 방법론상의 리스크가 아니라 A라는 가능성과 B라는 가능성의 비가 1:8이라는 사실로부터 직접적으로 인정되는 리스크다.

두 가지를 비유하자면,

+ 네이만-피어슨 식 가설검정의 리스크는 '**결론의 외측**'에 있고
+ 베이즈 추정의 리스크는 사후확률이라는 '**결론 그 자체**'에 있다.

### Insight ::: 베이즈 추정이 유의수준을 사용하지 않고 판정할 수 있는 이유

+ **사전확률이라는 '수상한' 것을 설정하기 때문이다**.
+ 앞에서 해설했듯이 사전확률이란 기본적으로는 '주관적'인 것이다.
    + '...라는 확률이다' (x)
    + '...라는 확률이라고 믿는다' (o)
    + '일단 ...라는 확률이라 설정해두자' (o)
+ 따라서 이와 같은 사전확률 하에서 추정되는 사후확률에는 항상 자의성이 있으며 그 책임은 통계가의 판단으로 남는다.

### Outline

1. 항아리가 A인가 B인가를 타입으로 설정한다.
2. 이유 불충분의 원리에 따라 A의 사전확률을 0.5, B의 사전확률을 0.5로 설정한다.
3. A에 든 검은 공의 조건부 확률을 0.1, 흰공의 조건부 확률을 0.9로 설정하고, B에 든 검은 공의 조건부 확률을 0.8, 흰 공의 조건부 확률을 0.2로 설정한다.
4. 관측된 공이 검은 공이라는 사실에 따라 흰 공일 가능성을 소거한다.
5. 검은 공의 확률에 대해 정규화 조건을 복구한다.
6. A일 사후확률과 B일 사후확률이 구해지고, '대체로 B일 것이다'라는 결론을 내린다.

**끝.**

---

# 제6강 명쾌하고 엄밀하지만 쓸 데가 한정된 네이만-피어슨 식 추정

## 용어 정리

## Summary

## 네이만-피어슨 통계학의 가설검정 원리

### 문제 설정

+ `사실 1` : 눈 앞에 항아리 A와 항아리 B가 있다.
+ `사실 2` : A에는 대체로 흰 공이 들어있다 (흰공:검은공=9:1)
+ `사실 3` : B에는 대체로 검은 공이 들어있다 (흰공:검은공=2:8)
+ `사실 4` : 검은 공이 나왔다

검은 공이 나온 항아리는 A일까, B일까?

### 네이만-피어슨 식 추정의 접근법

먼저, 대체로에 대한 확률적 기준을 마련한다.

+ '**대체로**'라는 확률적 수치가 일정 기준만 만족한다면 잘못된 판단을 할 리스크는 각오한다.
+ 예컨대 10%의 확률로 잘못된 결론을 내리는 것은 어쩔 수 없으니 눈감아 주는 것으로 판단해보자.

가설검정을 시작한다.

+ 정답이 항아리 A라고 가정하자.
+ `사실 2`를 'A에 100% 흰공이 들어있다'고 내용을 수정하자.
+ 수정한 `사실 2`가 잘못되었을 확률은 10%다. A에서 꺼낸 공이 흰색이 아니라 검정색일 확률이 0.1이기 때문이다.
+ 불과 10%나마 틀릴 가능성이 있는 이 결론 '100% 흰 공이다'와 `사실 4`를 합하면 모순이 일어난다.
+ 따라서 가정에 있는 A가 부정되고 'A가 아니다'라는 결론이 도출된다.
+ 이것을 통계학 전문용어로 '**가설 A는 기각된다**'고 말한다.
+ 마지막으로 `사실 1`과 'A가 아니다'를 바탕으로 B라는 결론이 난다.

이상이 표준 통계학(네이만-피어슨 통계학)의 추정 논리다.
포인트가 되는 부분은 '**대체로를 의미하는 확률 10%를 판단을 그르칠 리스크로서 받아들였다**'는 사실이다.
따라서 지금 내린 판단인 '항아리 B다'가 맞는지 틀리는지 그 자체는 알 수 없지만, **이 방법으로 계속 추정해 나가면 불과 10%의 확률이기는 하나 잘못된 결론을 내리게 된다**.
즉 '항아리 A임에도 항아리 B라고 결론짓는' 일이 발생한다.

### 네이만-피어슨 식 가설검정

위에서 설명한 확률적 추론 방법이 표준 통계학에서 말하는 '**가설검정**'이다. 대략적은 수순을 전문용어로 살펴보면 다음과 같다.

+ 1단계 : 검정하려는 가설 A를 세운다. 이 가설 A를 '**귀무가설**'이라 부른다.
+ 2단계 : A가 아닌 경우에 결론지을 B를 준비한다. 이 가설 B를 '**대립가설**'이라 부른다.
+ 3단계 : A가 옳다는 가정 하에, 작은 확률 alpha로밖에 관측되지 않는 현상 X를 생각한다.
+ 4단계 : 현상 X가 관측되었는가를 확인한다.
+ 5단계 : 현상 X가 관측된 경우 귀무가설 A가 틀렸다고 판단하여 귀무가설 A를 기각하고 대립가설 B를 채택한다.
+ 6단계 : 현상 X가 관측되지 않은 경우에는 귀무가설 A를 기각할 수 없으며 귀무가설 A를 채택한다.

이상의 프로세스를 요약해보면,

+ 귀무가설 A가 옳을 경우 alpha라는 낮은 확률로밖에 일어나지 않는 현상이 실제로 관측되었을 때, 귀무가설 A가 원래 잘못된 것이라고 판단하여 귀무가설 A를 버린다.
+ 관측되지 않았을 때는 버릴 이유가 없으므로 유지한다.

alpha는 무엇이냐면,

+ 귀무가설 A를 기각할 것인가의 기준이 되는 확률로써 전문용어로 '**유의수준**' 부른다.
+ alpha의 확률로 일어나는 현상이 관측되면 가설을 버리게 되므로 '올바른 가설 A를 잘못하여 버릴' 확률이 곧 alpha가 된다.
+ 즉 이 방법으로 계속 추정해 나가다 보면 alpha의 비율로 판단을 잘못 내리게 됨을 의미한다.

### 네이만-피어슨 식 가설검정을 항아리 문제에 적용하기

+ 귀무가설은 '항아리 A다'이다.
+ 대립가설은 당연히 '항아리 B다'가 된다.
+ 유의수준 alpha를 0.1로 설정하면 항아리 A로부터 검은 공이 나온느 것을 관측할 확률은 alpha가 된다.
+ 검은 공을 관측함으로써 귀무가설 A는 기각되고 대립가설 B가 채택된다.

### 가설검정의 핵심은 유의수준 alpha이다.

가설검정은 논리적 추론과 비교해봐도 거의 같은 발상에 입각한 상당히 명쾌한 방법론이다.
실제로 현대에는 이 방법이 널리 이용되고 있다.
단, 여기서 핵심은 유의수준 alpha이며 이를 몇으로 설정할 것인가가 중요한 문제가 된다.

유의수준 alpha는 '거의 관측되지 않을 것 같은 현상'의 확률을 뜻하기 때문에 당연히 작게 설정한다.
**보통은 5%(0.05) 또는 1%(0.01)로 설정한다**.
(단, 5% 혹은 1%로 설정하는 것에는 과학적 근거가 없다)

### 가설검정에서는 판단을 내리지 않는 사례도 있다.

그런데 위 항아리 문제에서 설정한 리스크 10%는 일반적인 유의수준 5%나 1%보다 훨씬 크다.
만약 항아리 문제의 유의수준을 일반적인 수치인 5%나 1%로 잡는다면 가설검정의 기준에 합치되지 않는다.

왜냐하면 가설 A를 기각할 기준으로 '검은 공이 나오는 것을 관측'하는 현상을 이용하는데, 이 확률은 10%라 일반적인 유의수준인 5%보다 훨씬 크기 때문이다.
마찬가지로 가설 B를 귀무가설로 해도 가설검정에 합치하지 않는다.
이 경우는 흰공이 나오는 사건을 현상 X로 두어야 하지만 이것도 20%의 확률이므로 유의수준을 충족하지 못하기 때문이다.

## Outline

1. 표준 확률적 추론은 네이만-피어슨 통계학에 따른 것이다.
2. 먼저 귀무가설과 대립가설을 설정한다.
3. 유의수준 alpha를 설정한다. 보통은 0.05 혹은 0.01로 잡는다.
4. 귀무가설 하에서 유의수준 alpha 이하로만 관측되는 현상 X에 주목한다.
5. 현상 X가 관측되었다면 귀무가설을 기각하고 대립가설을 채택한다.
6. 현상 X가 관측되지 않았다면 귀무가설을 채택한다.
7. 가설검정은 유의수준 alpha의 확률로 잘못될 수 있는 리스크를 가지고 있다.

**끝.**

---

# 제5강 추론의 프로세스에서 부각되는 베이즈 추정의 특징

## 용어 정리

## Summary

표준 통계학의 추정과 베이즈 추정은 불확실한 부분(ex. 대체로)에 대해서 다르게 해석한다.

## 논의

| 비교 | 표준 통계학 추정 | 베이즈 추정 |
| :--- | :--- | :--- |
| 대체로 B일 것이다 | 리스크는 있지만 B로 결론 짓자 | A와 B 모두 가능하지만 B쪽의 가능성이 훨씬 크다 |

## Outline

+ 논리적 추론(자연연역)은 논리학의 연역법에 따라 엄밀하게 결론을 도출한다.
+ 그런데 지식으로서 가지고 있는 사실에 불확실한 부분이 있을 때는 확률적 추론이 된다.
+ 확률적 추론에서는 '대체로 `**`다'라는 결론이 나온다.
+ 확률적 추론에는 표준 통계학 추정과 베이즈 추정의 2가지 방법이 있다.
+ 표준 통계학 추정에서는 일정한 리스크를 감수하고 '`**`다'와 같은 형식으로 하나의 결론을 내린다.
+ 베이즈 추정에서는 '양쪽다 가능하지만 `**`의 가능성이 더 높다'라는 형식으로 양다리 걸친 결론을 도출한다.

---

# 제4강 확률의 확률을 사용하여 추정의 폭을 넓힌다

## 용어 정리

+ `확률의 확률` : 타입을 확률로 설정했을 때, 특정 타입에 속할 확률
+ `표준 통계학` : 네이만-피어슨 통계학이라고도 불림.

> **Note:** 네이만과 피어슨은 지금의 통계학 형태를 완성한 통계학자들이다. 또 한 사람 중요한 공헌을 한 피셔라는 통계학자가 있어서 피셔-네이만-피어슨 통계학이라 부르기도 한다.

## Summary

참고할 만한 사전확률이 없고 타입이 3개 이상일 때는 타입(p=0.4)에 속할 확률(p=0.4일 확률 : 0.2), 즉 확률의 확률을 정해두면 베이즈 추정을 할 수 있다.

## 논의 (부제 없음)

### 문제설정

+ 어떤 부부의 첫째 아이가 여아였다.
+ 이때 그 부부에게서 태어날 둘째 아이가 여아일 확률은 몇일까?

이러한 문제설정이 의미가 있는지 의문을 가질 수 있다.
많은 이들이 '남녀가 태어날 확률은 반반이니 첫째가 여아였다는 사실은 당연히 둘째 아이의 성별과 관계가 없으며 다음에 태어날 아이가 여아일 확률 역시 반반일 것이다'라고 생각할 것이다.

첫째로, 통계적으로 봐도 남녀가 태어나는 비율은 반반이 아니다.
미미하나마 남아의 비율이 높다. 일본에서는 51:49로 남아 쪽이 많다.
비율의 차는 있어도 '남아 쪽이 많다'는 성질은 전 세계적으로 공통이라고 한다.
따라서 이를 동전 던지기와 같은 확률 현상으로 간주할 수는 없을 듯하다.

둘째로, 반반이라고 주장하는 사람들의 근거는 '다수의 부부에게 태어날 다수의 아이에 관한 통계'이지 '어느 특정한 부부에게 태어날 아이에 관한 통계'가 아니라는 점이다.
가령 인류 전체에 51:49와 같은 안정적인 비율이 있다 치더라도 어느 특정 부부에게서 태어날 아이의 남녀비가 이 비율과 동일하리라는 필연성은 없을 것이다.
이 부부에게 고유의 특성이 작용하며 '여아가 태어나기 조금 더 쉽다'든가 '남아가 태어나기 조금더 쉽다'라는 성향이 존재할 가능성도 부정할 수 없다.

### 표준 통계학의 한계

표준 통계학은 인류라는 종 전체에 내재된 남녀비와 같은 성향의 해명에는 효력이 있다.
그러나 **특정 부부에게 잠재해 있는 남녀 중 어느 한쪽이 태어나기 쉬운 특성 등의 문제에는 사용할 수 없다**.

**왜냐하면 표준 통계학은 어느 정도 많은 양의 데이터를 사용해야만 추정이 가능하기 때문이다**.
특정 부부로부터 통계적인 검증이 이루어질 수 있을 만큼 다수의 아이가 태어날 리도 없을뿐더러, 그만큼 많은 아이를 낳는 동안 연령의 증가로 인해 신체적인 조건도 달라질 것이다.

그러나 **특정 부부의 출산에 관한 추정도 베이즈 추정을 이용한다면 가능하다**. 그 이유는 **베이즈 추정이 지닌 '느슨하다'는 특성 때문이다**. 여기서 '느슨함'이란 사전확률이라는 불가사의한 것을 설정하는 것, 그리고 그 수치가 주관적이어도 좋다는 점을 뜻한다.

> **Note:** 표준 통계학은 '네이만-피어슨 통계학'이라고도 불린다.

### 1단계 : 확률의 확률을 사전확률로 설정한다.

+ 그 부부에게서 태어날 아이가 여아일 경우를 `타입 p`로 설정한다.
    + `타입 p`의 확률을 `p`라고 하자.
+ `타입 p`는 `0<=p<=1`을 만족하는 수이므로 연속적으로 분포하는 무한개의 수이다.
+ 여기서는 `타입 p`를 0.6, 0.5, 0.4의 세 값으로 설정해보자.
    + p = 0.6 : 여아를 낳기 쉬운 부부
    + p = 0.5 : 남녀가 반반의 확률로 태어날 것 같읕 부부
    + p = 0.4 : 남아를 낳기 쉬운 부부
+ 타입에 대한 사전확률을 설정한다.
+ 이 부부가 어느 타입에 속하는지 통계적인 데이터가 전혀 없으므로 '이유 불충분의 원리'를 채용하여 각 타입의 사전확률로 1/3씩 설정한다.

| 타입 | p=0.4 | p=0.5 | p=0.6 |
| :--- | :--- | :--- | :--- |
| 사전확률 | 1/3 | 1/3 | 1/3 |

+ 여기서 혼동하기 쉬운 것이, p와 1/3의 의미이다.
+ p는 '여아가 태어날 확률'을 나타낸다.
+ 1/3은 각 타입의 '**사전확률**'이면서, 동시에 p 자체도 확률이므로 '**확률의 확률**'이다.

앞의 강의까지는 타입이 확률과 무관했지만 '**이번에는 타입이 확률 p로 표현되었다는 점**'이 다르다.
즉 이 부부는 '여아를 낳을 확률이 0.4'인 세계, '여아를 낳을 확률이 0.5'인 세계, 그리고 '여아를 낳을 확률이 0.6'인 세계 중 하나의 세계에 속해 있는데, 어느 세계에 있는지 알 수 없어서 추측의 대상일 뿐이다.
그리고 어느 타입일 확률이 나머지 타입보다 더 높거나 낮다고 볼 수 없으므로 '이유 불충분의 원리'를 적용해 사전확률을 모두 1/3로 설정한 것이다.

참고로 인류라는 종을 통계적으로 봤을 때 p=0.5가 될 가능성이 다른 두 가지보다 훨씬 높다고 생각한다면 사전분포의 설정을 바꾸면 된다.
예컨대 p=0.4인 사전확률과 p=0.6인 사전확률을 각각 0.2로, p=0.5인 사전확률을 0.6으로 두는 것도 가능하다.

사전확률의 설정에서 지금까지와 다른 점이 한 가지 더 있다. '**지금까지는 2가지였던 타입이 이번에는 3가지라는 점**'이다. 이번 강의를 이해한다면 타입이 몇 개가 되든 유한하기만 하면 추정할 수 있게 될 것이다.

### 2단계 : 타입에 속할 확률을 그대로 조건부 확률로 사용한다.

+ 타입별로 특정 행동을 초래하는 조건부 확률을 설정해야 한다.
    + 행동 1: 여아를 낳는 경우
    + 행동 2: 남아를 낳는 경우
+ 그런데 이번에는 매우 간단하다.
+ 왜냐하면 타입 그 자체가 그 조건부 확률이 되기 때문이다.
+ 예컨대 그 부부가 속한 타입이 p=0.4라면, 그 부부가 여아를 낳을 조건부 확률은 그대로 0.4가 된다. 그리고 당연히 남아를 낳을 확률은 1-0.4=0.6이다.

| 타입 | 여아를 낳을 확률 | 남아를 낳을 확률 |
| :--- | :--- | :--- |
| p=0.4 | 0.4 | 0.6 |
| p=0.5 | 0.5 | 0.5 |
| p=0.6 | 0.6 | 0.4 |

+ 그 부부가 여아/남아를 낳을 조건부 확률은 위 표와 같다.
+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | p=0.4 (1/3) | p=0.5 (1/3) | p=0.6 (1/3) |
| :--- | :--- | :--- | :--- |
| 여아 (0.4, 0.4, 0.6) | 0.4/3 | 0.5/3 | 0.6/3 |
| 남아 (0.6, 0.5, 0.4) | 0.6/3 | 0.5/3 | 0.4/3 |

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 이 부부는 '첫째가 여아였다'는 현실에 직면해 있다.
+ 따라서 첫째가 남아라는 세계는 사라진다.

| 타입 | p=0.4 (1/3) | p=0.5 (1/3) | p=0.6 (1/3) |
| :--- | :--- | :--- | :--- |
| 여아 (0.4, 0.4, 0.6) | 0.4/3 | 0.5/3 | 0.6/3 |

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해 1이 되도록 정규화시킨다.
    + 0.4/3 : 0.5/3 : 0.6/3
    + 4:5:6
    + 4/15 : 1/3 : 2/5

| 타입 | p=0.4 | p=0.5 | p=0.6 |
| :--- | :--- | :--- | :--- |
| 여아 | 0.27 (4/15) | 0.33 (1/3) | 0.4 (2/5) |

## Insight ::: 베이즈 갱신 결과

베이즈 갱신 결과,

+ 여아가 태어나기 전에는 3가지 타입의 가능성이 모두 대등하였다.
    + p=0.4의 사전확률 : 0.33
    + p=0.5의 사전확률 : 0.33
    + p=0.6의 사전확률 : 0.33
+ 첫째 아이가 여아였다는 정보에 의해,
    + p=0.4의 사전확률 : 0.27
    + p=0.5의 사후확률 : 0.33
    + p=0.6의 사후확률 : 0.4
+ 따라서 이 부부는 p=0.6 타입에 속할 확률이 가장 높다.
+ 즉, **'여아가 태어났다'는 정보를 얻은 후에는 그 전에 비해 '여자아이를 낳기 쉬운 부부다'라고 추정 결과가 달라진다**.

이번 베이즈 추정으로 얻은 사후확률은 타입별 확률, 즉 확률의 확률이다.
결국 다음 여아가 태어날 확률이 얼마인지는 여전히 모른다.
어떻게 구할 수 있을까?

## Insight ::: 객관확률과 주관 확률 혼재

+ 타입을 나타내는 확률 p : 객관 확률
+ 사전확률 및 사후확률 : 추정자의 마음에 의거한 주관 확률

## Insight ::: 사후확률로부터 기대치 구하기

이 부부에게 다음에 여아가 태어날 확률을 구하려면 기대치를 사용하면 된다.

### 1단계 : 각 타입의 확률과 사후확률을 곱한다.

| 타입 | p=0.4 (0.27) | p=0.5 (0.33) | p=0.6 (0.4) |
| :--- | :--- | :--- | :--- |
| p (0.4, 0.5, 0.6) | 0.108 | 0.165 | 0.24 |

+ 0.4 * 0.27 = 0.108
+ 0.5 * 0.33 = 0.165
+ 0.6 * 0.4 = 0.24

### 2단계 : 기대치를 구한다.

+ p의 기대치 = 0.108 + 0.165 + 0.24 = 0.513

이 부부의 타입을 평균화하면 0.513이며 이것이 이 부부로부터 다음 태어날 아이가 여아일 확률과 같다.

## Outline

1. 타입을 확률로 설정하고, 그에 대한 사전확률을 설정한다.
    + 데이터를 얻을 수 없으므로 이유 불충분 원리를 채용하여 대등하게 설정한다.
    + 사전확률은 '확률의 확률'이 된다.
2. 조건부 확률을 설정한다.
    + 타입의 확률 그 자체로 설정하면 된다.
3. 얻은 정보로부터 일어나지 않을 가능성을 소거한다.
    + 첫째 아이가 여아였다.
4. 남은 세계의 확률값에 대해 정규화 조건을 복구한다.
5. 타입에 대한 사후확률(베이즈 역확률)을 구한다.
6. 사전확률이 얻은 정보에 의해 사후확률로 갱신된다(베이즈 갱신).
7. 사전확률과 사후확률은 모두 주관 확률이다.
8. 각 타입의 확률이 나왔으므로 그것을 평균화하여 타입의 평균치를 구할 수 있다.
    + 그것이 다음에 태어날 아이가 여아일 확률이 된다.

**끝.**

---

# 제3강 주관적인 숫자여도 추정이 가능하다

## 용어 정리

+ `이유 불충분의 원리` : 주장과 반박에 대해 양쪽 다 어떠한 근거도 없을 때는 일단 대등하다고 생각한다.

## Summary

베이즈 추정에서는 사전확률로 참고할 만한 객관적인 자료가 없거나, 사전확률로써 사람의 심리 같은 주관적인 확률을 사용해야 할 때도 추정이 가능하다.

## 부제 : 곤란한 상황에서 쓰는 '이유 불충분의 원리'

### 지금까지의 베이즈 추정의 단계

1. 사전확률
2. 조건부 확률
3. 관측에 의한 정보 입수
4. 사후확률

제1강과 제2강에서 사전확률은 객관적인 데이터를 참고하여 설정했다. 그러나 '**객관적인 사전 데이터가 없어도 추정이 가능하다**'는 것이 '**베이즈 추정의 진정한 면모**'이다. 즉 '**사전확률을 주관적으로 설정하여 추정을 실시할 수가 있다**'는 뜻이다.

### 문제설정

+ 당신은 남성이다.
+ 특정 여성 동료가 자신에게 호감을 가지고 있는지 알고 싶다.
+ 그런 와중에 밸런타인데이에 그녀로부터 초콜릿을 받았다.
+ 이때 그녀가 당신을 진지하게 생각하고 있을 확률이 얼마라고 추정해야 할까?

이 문제설정의 가장 중요한 포인트는 '**사람의 속마음을 수치화해야 한다**'는 점이다. 여기에는 객관성이 전혀 없다.

또 여기서 말하는 '마음에 두고 있을 확률'에서의 **'확률'이 뜻하는 바도 생각할수록 그 의미가 와 닿지 않는다**.

이번 문제설정은 통상의 통계/확률의 상식에서 상당히 일탈됐다. 하지만 베이즈 추정은 이와 같은 문제에도 접근할 수 있다. 거꾸로 말하면 이 점이 베이즈 추정의 진가를 발휘할 수 있는 강점이라 할 만하다.

### 1단계 : 주관적으로 사전확률을 설정한다.

+ 타입을 `진심`과 `논외`로 약칭한다.
    + `진심` : 그녀가 당신을 마음에 두고 있다.
+ 이때는 '이유 불충분의 원리'를 끌어다 써서 일단 대등하다고 생각한다.
    + `진심` : 0.5
    + `논외` : 0.5

> **Note:** 이유 불충분의 원리 : 통계적인 접근이 불가능한 데다 어느 쪽이 우세하다고 생각할 근거도 없으므로 임의의 수치로 대등하게 0.5씩 할당한다.

### 2단계 : 특정 행동에 대한 조건부 확률을 설정한다.

+ '여성이 마음에 두고 있는 남성과 논외인 남성에게 각각 어느 정도의 확률로 초콜릿을 주는가'를 알아내기 위해 앙케이트 조사를 잡지사에 부탁했다.
+ 진심으로 생각하는 상대에게 주는 확률이 50% 이하라는 것도 의외였지만, 논외인 상대에게 22%나 되는 확률로 준다는 것에 '예의상 초콜릿을 주는 습관'의 대단함을 실감했다.

| 타입 | 초콜릿을 줄 확률 | 초콜릿을 주지 않을 확률 |
| :--- | :--- | :--- |
| 진심 | 0.4 | 0.6 |
| 논외 | 0.2 | 0.8 |

+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | 진심 (0.5) | 논외 (0.5) |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 (0.4, 0.2) | 0.2 | 0.1 |
| 초콜릿을 주지 않을 확률 (0.6, 0.8) | 0.3 | 0.4 |

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 초콜릿을 받은 현실에 직면해 있다.
+ 초콜릿을 주지 않을 확률을 제거한다.

| 타입 | 진심 (0.5) | 논외 (0.5) |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 (0.4, 0.2) | 0.2 | 0.1 |

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해서 1이 되도록 정규화시킨다.
    + 0.2 : 0.1 = 2/3 : 1/3

| 타입 | 진심| 논외 |
| :--- | :--- | :--- |
| 초콜릿을 줄 확률 | 2/3 | 1/3 |

+ 초콜릿을 받았을 때, 그녀가 당신을 `진심`으로 생각할 사후확률은 약 66%이다.

## Insight ::: 베이즈 갱신 결과

베이즈 갱신 결과,

+ 사전확률 0.5에서 사후확률 0.66으로 올라갔다.
+ 초콜릿을 받았기 때문에 당신의 기대감이 이전보다 높아지는 것은 당연하다.
+ 그래도 66%에 머물기 때문에 과잉 기대는 금물이다.

만약 이유 불충분의 상황이라 하더라도 사전확률을 반반으로 설정하는 것이 너무 자신감 넘치는 행위가 아닌지 의심된다면,

+ `진심` : 0.4, `논외` : 0.6 으로 설정하면 된다.

## Insight ::: 주관적 확률

학교 교육에서 배우는 확률은 객관적 확률이다. 누가 계산하든 같은 값이 나온다는 점에서 객관성을 띤다.
가령 '주사위를 던져서 1이 나올 확률이 6분의 1'이라고 말하는 것은 객관적 확률이다. '주사위를 던질 때 1이 나올 가능성의 정도'를 나타내며 모든 사람의 공통된 판단으로 여긴다.

그러나 이번 강의에서 다룬 확률에는 그러한 객관성이 적용되지 않는다.
'동료 여성이 당신을 마음에 두고 있을 확률'에서 '확률'이란 종래의 주사위의 확률과 같은 해석이 불가능하다. 왜 그럴까?

객관적 확률에서 확률은 n번 실험하여 특정 이벤트가 일어나는 상대적 빈도로 정의한다. 따라서 주사위도 여러 차례 던질 수 있음을 전제로 한다.
하지만 이 여성은 세상에 단 한 명이고 당신에 대해 진심으로 생각하는 경우를 여러 번 실험하여 일어나는 상대적 빈도로 계산할 수 없다.
그리고 그녀가 당신을 진심 혹은 논외로 생각하는가를 결정하는 것은, 앞으로 일어날 확률적인 사항이 아니라 이미 결론이 나 있고 그저 당신이 그것에 모르는 것에 지나지 않는다.

> **Note:** 객관적 확률은 명쾌하고 엄밀하지만 실제로 쓸 데가 한정되어 있다.

따라서 '동료 여성이 당신을 마음에 두고 있을 확률'에서 그 '확률'은 **당신 마음 속의 '믿음의 정도'와 같은 것이라고 해석해야 한다**.
즉 '확률은 몇이다'가 아니라, 오히려 '나는 확률이 몇이라고 생각한다'라는 의미로 이해해야 한다.

이와 같이 '사람이 마음으로 생각하는 수치'라고 해석하는 확률을 '**주관적 확률**'이라고 한다.

이에 대해 믿을 수 없는 것이라고 여기는 사람도 많고 학교 교육에서도 배우지 않는다.
그러나 주관적 확률은 확률의 사고법으로써는 유서 깊은 방식이며, 통계학이나 경제학에서는 당당히 사용되는 개념이다.

> **Note:** 17세기 인도의 수학자 라이프니츠는 '신빙성', '증거능력'이 확률이라고 생각했다. 법학자이기도 했던 라이프니츠는 재판에서의 추론을 고찰했다. 재판에서는 피고인의 유죄를 증거로부터 증명해 나간다. 이때 피고인이 유죄일 '신빙성'은 주관 확률로 구성된다고 해석했다.


**끝.**

---

# 제2강 베이즈 추정은 때로 직감에 크게 반한다

## 용어 정리

## Summary

조건부 확률(`양성일 확률 95%`)이 매우 높더라도 특정 타입에 속할 사전확률(`암 이환율 0.1%`)이 매우 낮다면 최종적인 사후확률(`암 검사 결과 양성일 때 실제 암에 걸렸을 확률 4.5%`)은 매우 낮을 수 있다.
따라서 **조건부 확률만 볼 것이 아니라 사전확률도 함께 고려해야 한다**.
그러나 의료 사건의 경우 아주 작은 확률(`ex. 4.5%`)도 100명 당 확률(`ex. 약 20명 중 1명`)로 계산하면 절대로 무시할 수 없다.

## 부제 : 객관적인 데이터를 사용할 때 주의할 점

### 스토리

+ 어떤 환자가 '특정 암에 걸려 있다면 95%의 확률로 양성이 나오는 검사'를 받았다.
+ 양성 판정이 나왔다.
+ 그 환자가 암에 걸려 있을 확률이 95%일까?
+ 정답은 '아니오'이다.
+ 양성이라는 '결과'로부터 '암이다'라는 '원인'으로 거슬러 올라가는 추정이므로, 베이즈 추정의 전형적인 예시이다.

### 문제설정

+ 암에 걸릴 확률(이환율) = 0.1%(0.001)
+ 암에 걸린 사람이 양성으로 진단받을 확률 = 95%(0.95)
+ 건강한 사람이 양성으로 오진 받을 확률 = 2%(0.02)
+ 검사에서 양성이라고 진단받았을 때, 실제로 이 암에 걸려 있을 확률은 얼마일까?

### 1단계 : 사전확률을 설정한다.

+ 환자를 두 가지 타입으로 나눈다
    + `암에 걸린 사람`과 `건강한 사람`
+ 타입에 대한 비율을 경험에 비추어 정한다.
    + `암에 걸린 사람` : 0.001
    + `건강한 사람` : 0.999

### 2단계 : 특정 행동에 대한 조건부 확률을 설정한다.

| 타입 | 양성일 확률 | 음성일 확률 |
| :--- | :--- | :--- |
| 암에 걸린 사람 (0.001) | 0.95 | 0.05 |
| 건강한 사람 0.999) | 0.02 | 0.98 |

+ 전체 세계의 관점에서 확률을 구한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|
| 음성 (0.05, 0.98) | 0.005% | 97.902% |

+ 가독성을 우선시하여 100배하여 %로 나타내었다.

### 3단계 : 일어날 가능성이 없는 세계를 지운다.

+ 검사 결과가 양성이다.
+ 음성에 대한 경우를 제거한다.

| 타입 | 암에 걸린 사람 (0.001) | 건강한 사람 (0.999) |
| :--- | :--- | :--- |
| 양성 (0.95, 0.02) | 0.095% | 1.998%|

### 4단계 : 베이즈 역확률을 구한다.

+ 전체 확률을 더해서 1이 되도록 정규화시킨다.
    + 0.095 : 1.998 = 0.095/2.093 : 1.998/2.093

> **Note:** 0.095 + 1.998 = 2.093

| 타입 | 암에 걸린 사람 | 건강한 사람 |
| :--- | :--- | :--- |
| 양성 | 0.0454 | 0.9546|

+ 양성이 나온 사람이 암에 걸렸을 확률은 약 4.5%이다.

## Insight ::: 베이즈 갱신 결과

위 내용을 두 문장으로 요약하면 다음과 같다.

+ '95% 감도인 암 검사에서 양성이 나온다면 당신은 95%의 확률로 암인가?'
+ 아니다. 95%는커녕 불과 4.5%이다.

## Insight ::: 조건부 확률에 비해 사후확률이 매우 낮은 이유

왜 이렇게 확률이 낮을까?

+ 첫째, 원래 암에 걸린 사람(0.1%) 자체가 매우 드물다.
+ 둘째, 건강한 사람을 양성으로 진단하는 확률은 2%이므로 적어보이지만, 건강한 사람이 압도적으로 많으므로 건강한 사람을 양성으로 진단하는 사례는 실제로 무시할 수 없을 만큼 많다.

그렇다면 완전히 마음을 놓아도 될까?

+ 그 또한 아니다.
+ 아무런 관측이 이루어지지 않았을 때, 당신이 암에 걸렸을 확률은 0.001 (사전확률)이었다.
+ '양성'이 관측된 후에는 수치가 갱신되어 0.045(사후확률)가 되었다.
+ 즉, 0.1%에서 4.5%로 45배 커졌다.
+ 검사 결과를 보기 전에는 1000명 중에 1명 정도의 가능성이었으나,
+ 검사 결과 양성이 나온 지금은 약 20명 중 1명 정도의 가능성으로 높아졌다.
+ 결코 방치해도 되는 상태는 아니다.

**끝.**

---

# 제1강 정보를 얻으면 확률이 바뀐다

## 용어 정리

+ `사전확률` : 타입(input)에 대한 확률
+ `정규화 조건` : 각 타입의 사전확률의 합이 1이 되도록 함
+ `조건부 확률` : 특정 타입이 특정 행동(output)을 할 확률
    + 타입(원인)을 알고 있을 때의 결과의 확률
+ `베이즈 역확률` 또는 `사후확률` :
    + 특정 타입(input)이 특정 행동(output)을 할 확률이 사전확률인 반면,
    + 특정 행동(output)을 한 사람이 특정 타입(input)일 확률을 역으로 구하므로 역확률이라고 한다
+ `베이즈 갱신` : 사전확률과 조건부 확률을 설정한 상태에서 새롭게 관측한 행동을 반영하여 사후 확률을 구하는 것. (기존 확률을 업데이트한다)
+ `베이즈 추정` : 사전확률을 행동의 관찰을 통해 사후확률로 베이즈 갱신을 하는 것

## Summary

베이즈 추정은 사전확률과 조건부 확률을 설정한 이후 특정 행동을 관찰해서 사후확률을 업데이트한다.
이는 직감적인 판단을 수치화하여 계산하는 방법으로, 이미 많은 기업에서 활용하고 있으며 추후 AI에 활용할 수도 있다.

## 부제 : 베이즈 추정의 기본적인 사용 방법

### 스토리

+ 상품 판매점 점원은 손님이 '`쇼핑족`인가 아니면 `아이쇼핑족`인가'를 판별하고 싶다.
+ `쇼핑족`에게는 원하는 상품을 소개하여 실제로 구매하도록 유도해야 한다.
+ `아이쇼핑족`에게는 시간을 들여 설명해도 구매하지 않을 뿐더러 손님 입장에서 귀찮게 느끼므로 역효과이다.

### 1단계 : 경험에서 '사전확률'을 설정한다

+ 손님의 두 가지 타입을 나눈다
    + `쇼핑족`과 `아이쇼핑족`
+ 타입을 나누고 그 비율이 각각 몇인지 **경험에 비추어** 수치를 배정한다.
    + `쇼핑족` : 0.2
    + `아이쇼핑족` : 0.8
+ 단, 사전확률은 전부 더해서 1이 되도록 설정한다.

> **Note:** 사전확률은 보통 경험에 근거해 할당하지만, 경험이 없는 경우도 할당할 수도 있다. 추후 언급할 것이다.

### 2단계 : 타입별로 특정 행동에 대한 '조건부 확률'을 설정한다

+ 특정 행동은 반드시 상호배타적이어야 하며, 정규화 조건을 만족해야 한다.
+ `쇼핑족` 손님과 `아이쇼핑족` 손님이 각각 점원에게 '말 걸기' 행동을 할 확률을 **반드시 근거가 있는 경험에 비추어** 정한다.

> **Note:** 사전확률은 경험이 없어도 할당할 수 있다. 그러나 타입의 차이에 따른 행동의 확률은 어떤 경험, 실증, 실험에 기반을 둔 수치가 반드시 필요하다.

| 타입 | 말을 걸 확률 | 말을 걸지 않을 확률 |
| :--- | :--- | :--- |
| 쇼핑족 (0.2) | 0.9 | 0.1 |
| 아이쇼핑족 0.8) | 0.3 | 0.7 |

+ 각 타입의 '말을 걸 확률'과 '말을 걸지 않을 확률'의 합은 1이다.
+ 위 표에 제시된 확률은 '조건부 확률'이다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |
| 말을 걸지 않는다 (0.1, 0.7) | 0.02 | 0.56 |

+ 전체 세계의 관점에서 각 타입이 특정 행동을 할 최종 확률은 위 표와 같다.

### 3단계 : 관측한 행동에서 '가능성이 사라진 세계'를 제거한다

+ 지금 손님이 말을 걸었다.
+ 손님의 행동을 한 가지 관측했으므로 가능성이 사라진 '말을 걸지 않는' 행동을 제거한다.

| 타입 | 쇼핑족 (0.2) | 아이쇼핑족 (0.8) |
| :--- | :--- | :--- |
| 말을 건다 (0.9, 0.3) | 0.18 | 0.24 |

### 4단계 : 특정 타입에 대한 베이즈 역확률을 구한다

+ 4개의 가능성에서 2개의 가능성으로 좁혀졌다.
+ 전체 확률을 더해도 1이 되지 않으므로, 정규화 조건을 회복시킨다.
    + 0.18 : 0.24 = 3 : 4 = 3/7 : 4/7

| 타입 | 쇼핑족 | 아이쇼핑족 |
| :--- | :--- | :--- |
| 말을 건다 | 3/7 | 4/7 |

+ 말을 걸어온 손님이 `쇼핑족`일 확률은 3/7이다.
+ 이 확률을 '베이즈 역확률' 또는 '사후확률'이라 부른다.

## Outline

1. 타입에 대한 사전확률을 설정한다.
    + ex. 쇼핑족과 아이쇼핑족
2. 각 타입의 행동에 대한 조건부 확률을 설정한다.
    + ex. 각각 말을 걸 확률은?
3. 행동을 관측한다.
    + ex. 말을 걸어왔다.
4. 일어나지 않을 행동에 대한 가능성을 제거한다.
    + ex. 말을 걸지 않는 경우를 지운다.
5. 남아 있는 경우의 확률을 정규화한다.
    + ex. 남아 있는 경우의 확률이 1이 되도록 만든다.
6. 사후확률 (베이즈 역확률)을 구한다.
    + ex. 가능성을 갱신해서 말을 거는 손님이 살 확률을 구한다.

**끝.**

---
